NAME = wrf
SRCS = $(shell find src -name "*.c")
SRCS += src/module_driver_constants.F90 src/module_wrf_error.F90 src/module_state_description.F90 src/module_configure.F90 src/ESMF_Base.F90 src/ESMF_BaseTime.F90 src/ESMF_Calendar.F90 src/ESMF_Fraction.F90 src/ESMF_TimeInterval.F90 src/ESMF_Time.F90 src/ESMF_Alarm.F90 src/ESMF_Clock.F90 src/Meat.F90 src/ESMF_Mod.F90 src/module_machine.F90 src/module_domain.F90 src/module_timing.F90 src/module_nesting.F90 src/module_integrate.F90 src/module_tiles.F90 src/module_sm.F90 src/module_io.F90 src/module_dm_stubs.F90 src/module_quilt_outbuf_ops.F90 src/module_io_quilt.F90 src/module_bc.F90 src/module_bc_time_utilities.F90 src/module_date_time.F90 src/module_io_wrf.F90 src/module_io_domain.F90 src/module_model_constants.F90 src/module_soil_pre.F90 src/module_bl_mrf.F90 src/module_sf_myjsfc.F90 src/module_bl_myjpbl.F90 src/module_bl_ysu.F90 src/module_cu_bmj.F90 src/module_mp_kessler.F90 src/module_mp_ncloud5.F90 src/module_ra_sw.F90 src/module_sf_sfclay.F90 src/module_cu_kf.F90 src/module_cu_kfeta.F90 src/module_mp_lin.F90 src/module_mp_wsm3.F90 src/module_mp_wsm5.F90 src/module_mp_wsm6.F90 src/module_sf_sfcdiags.F90 src/module_sf_slab.F90 src/module_sf_ruclsm.F90 src/module_sf_noahlsm.F90 src/module_surface_driver.F90 src/module_cu_gd.F90 src/module_ra_gsfcsw.F90 src/module_mp_ncloud3.F90 src/module_mp_etanew.F90 src/module_ra_rrtm.F90 src/module_ra_gfdleta.F90 src/module_physics_init.F90 src/module_physics_addtendc.F90 src/module_solvedebug_em.F90 src/module_bc_em.F90 src/module_advect_em.F90 src/module_big_step_utilities_em.F90 src/module_diffusion_em.F90 src/module_small_step_em.F90 src/module_em.F90 src/module_init_utilities.F90 src/module_optional_si_input.F90 src/wrf_shutdown.F90 src/mediation_integrate.F90 src/mediation_feedback_domain.F90 src/mediation_force_domain.F90 src/mediation_interp_domain.F90 src/mediation_wrfmain.F90 src/wrf_auxhist1in.F90 src/wrf_auxhist1out.F90 src/wrf_auxhist2in.F90 src/wrf_auxhist2out.F90 src/wrf_auxhist3in.F90 src/wrf_auxhist3out.F90 src/wrf_auxhist4in.F90 src/wrf_auxhist4out.F90 src/wrf_auxhist5in.F90 src/wrf_auxhist5out.F90 src/wrf_auxinput1in.F90 src/wrf_auxinput1out.F90 src/wrf_auxinput2in.F90 src/wrf_auxinput2out.F90 src/wrf_auxinput3in.F90 src/wrf_auxinput3out.F90 src/wrf_auxinput4in.F90 src/wrf_auxinput4out.F90 src/wrf_auxinput5in.F90 src/wrf_auxinput5out.F90 src/wrf_bdyin.F90 src/wrf_bdyout.F90 src/wrf_histin.F90 src/wrf_histout.F90 src/wrf_inputin.F90 src/wrf_inputout.F90 src/wrf_restartin.F90 src/wrf_restartout.F90 src/couple_or_uncouple_em.F90 src/interp_domain_em.F90 src/interp_fcn.F90 src/nest_init_utils.F90 src/set_timekeeping.F90 src/sint.F90 src/solve_interface.F90 src/start_domain.F90 src/module_pbl_driver.F90 src/module_radiation_driver.F90 src/module_cumulus_driver.F90 src/module_microphysics_driver.F90 src/solve_em.F90 src/start_em.F90 src/internal_header_util.F90 src/io_int.F90 src/init_modules_em.F90 src/init_modules.F90 src/wrf_io.f90 src/field_routines.f90 src/wrf.F90 src/netcdf/typeSizes.f90 src/netcdf/netcdf.f90
CFLAGS = -I./src -I./src/netcdf/include -DSPEC_CPU_CASE_FLAG -DSPEC_CPU_LINUX
FFLAGS = -I./ -I./netcdf/include -I./include -std=legacy -fallow-argument-mismatch
LD_FORTRAN = 1
SPECPPFLAGS = -w -m literal.pm -I. -DINTIO -DIWORDSIZE=4  -DDWORDSIZE=8 -DRWORDSIZE=4 -DLWORDSIZE=4 -DNETCDF  -DTRIEDNTRUE -DLIMIT_ARGS -DEM_CORE=1  -DNMM_CORE=0 -DNMM_MAX_DIM=1000 -DCOAMPS_CORE=0  -DEXP_CORE=0 -DF90_STANDALONE -DCONFIG_BUF_LEN=8192 -DMAX_DOMAINS_F=21 -DNO_NAMELIST_PRINT -DSPEC_CPU -DNDEBUG -DSPEC_CPU_LP64 -DSPEC_CPU_CASE_FLAG -DSPEC_CPU_LINUX
include ../Makefile.apps

test-cmp:
	$(call SPECDIFF, --abstol 0.01  --reltol 0.05, run/rsl.out.0000, data/test/output/rsl.out.0000)

train-cmp:
	$(call SPECDIFF, --abstol 0.01  --reltol 0.05, run/rsl.out.0000, data/train/output/rsl.out.0000)

ref-cmp:
	$(call SPECDIFF, --abstol 0.01  --reltol 0.05, run/rsl.out.0000, data/ref/output/rsl.out.0000)
